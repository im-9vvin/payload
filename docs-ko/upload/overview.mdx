---
title: 업로드
label: 개요
order: 10
desc: Payload는 강력한 파일 접근 제어와 함께 서버에서 직접 파일 업로드, 저장 및 관리를 지원합니다.
keywords: uploads, images, media, overview, documentation, Content Management System, cms, headless, javascript, node, react, nextjs
---

<Banner>
  Payload는 매우 강력한 파일 [접근 제어](#access-control)를 포함하여 서버에서
  직접 파일 업로드, 저장 및 관리를 활성화하는 데 필요한 모든 것을 제공합니다.
</Banner>

<LightDarkImage
  srcLight="https://payloadcms.com/images/docs/upload-admin.jpg"
  srcDark="https://payloadcms.com/images/docs/upload-admin.jpg"
  alt="Payload 관리 패널에서 업로드가 활성화된 컬렉션을 보여줍니다"
  caption="업로드가 활성화된 미디어 컬렉션을 보여주는 관리 패널 스크린샷"
/>

**업로드의 일반적인 사용 사례는 다음과 같습니다:**

- 사이트나 앱 전체에서 사용할 이미지를 포함하는 "미디어 라이브러리" 생성
- 사용자가 전자책 PDF, 백서 등과 같은 다운로드 가능한 자산에 접근하기 위해 가입해야 하는 게이트 콘텐츠 라이브러리 구축
- 소프트웨어, ZIP 파일, MP4 등과 같은 공개적으로 사용 가능한 다운로드 가능한 자산 저장

**컬렉션에서 업로드 기능을 활성화하는 것만으로도 Payload는 자동으로 컬렉션을 강력한 파일 관리/저장 솔루션으로 변환합니다. 다음 수정 사항이 적용됩니다:**

1. `filename`, `mimeType`, `filesize` 필드가 컬렉션에 자동으로 추가됩니다. 선택적으로 컬렉션의 업로드 구성에 `imageSizes`를 전달하면 자동으로 크기가 조정된 이미지 크기와 파일명을 포함하는 [`sizes`](#image-sizes) 배열도 추가됩니다.
1. 관리 패널은 목록 보기에서 각 업로드의 썸네일을 표시하도록 내장된 `List` 컴포넌트를 수정합니다
1. 관리 패널은 파일 업로드를 허용하는 새로운 해당 업로드 UI 세트를 추가하도록 `Edit` 보기를 수정합니다
1. `create`, `update`, `delete` 컬렉션 작업은 파일 업로드, 재업로드 및 삭제를 지원하도록 수정됩니다

## 업로드 활성화

모든 Payload 컬렉션은 컬렉션의 구성에서 `upload` 속성을 `true`로 지정하거나 `upload` 옵션을 포함하는 객체로 지정하여 업로드 지원을 선택할 수 있습니다.

<Banner type="success">
  **팁:**

일반적인 패턴은 **"media"** 컬렉션을 생성하고 해당 컬렉션에서 **upload**를 활성화하는 것입니다.

</Banner>

```ts
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    staticDir: 'media',
    imageSizes: [
      {
        name: 'thumbnail',
        width: 400,
        height: 300,
        position: 'centre',
      },
      {
        name: 'card',
        width: 768,
        height: 1024,
        position: 'centre',
      },
      {
        name: 'tablet',
        width: 1024,
        // `undefined`를 지정하거나 높이를 정의하지 않으면
        // 이미지는 특정 너비로 크기가 조정되지만
        // 원래 종횡비를 유지하고
        // 높이를 자동으로 계산합니다.
        height: undefined,
        position: 'centre',
      },
    ],
    adminThumbnail: 'thumbnail',
    mimeTypes: ['image/*'],
  },
  fields: [
    {
      name: 'alt',
      type: 'text',
    },
  ],
}
```

### 컬렉션 업로드 옵션

_별표는 필수 옵션을 나타냅니다._

| 옵션                            | 설명                                                                                                                                                                                                                                                                           |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **`adminThumbnail`**           | [관리 패널](../admin/overview)이 이 컬렉션에 대한 썸네일을 표시하는 방법을 설정합니다. [자세히](#admin-thumbnails)                                                                                                                                                              |
| **`bulkUpload`**               | 사용자가 목록 보기에서 대량 업로드할 수 있도록 허용합니다. 기본값은 true입니다                                                                                                                                                                                                  |
| **`cacheTags`**                | 관리 썸네일 컴포넌트의 UI에 설정된 캐시 태그를 비활성화하려면 `false`로 설정합니다. CDN이 특정 캐시 쿼리를 허용하지 않는 경우에 유용합니다.                                                                                                                                    |
| **`constructorOptions`**       | Sharp 이미지 라이브러리에 전달되는 객체로, 생성자 옵션을 수용하고 업로드 파일에 적용합니다. [자세히](https://sharp.pixelplumbing.com/api-constructor/)                                                                                                                       |
| **`crop`**                     | [관리 패널](../admin/overview)에서 자르기 도구를 비활성화하려면 `false`로 설정합니다. 자르기는 기본적으로 활성화되어 있습니다. [자세히](#crop-and-focal-point-selector)                                                                                                        |
| **`disableLocalStorage`**      | 로컬로 디스크에 파일 업로드를 완전히 비활성화합니다. [자세히](#disabling-local-upload-storage)                                                                                                                                                                                 |
| **`displayPreview`**           | 이 컬렉션과 관련된 업로드 필드에서 업로드된 파일의 미리보기 표시를 활성화합니다. 업로드 필드의 `displayPreview` 옵션으로 로컬에서 재정의할 수 있습니다. [자세히](/docs/fields/upload#config-options).                                                                         |
| **`externalFileHeaderFilter`** | 기존 헤더를 수용하고 필터링 또는 수정 후 헤더를 반환합니다. 이 옵션을 사용하는 경우, 외부 서비스로 세션 정보가 유출되는 것을 방지하기 위해 민감한 쿠키(payload 접두사가 있는 쿠키 등)의 제거를 처리해야 합니다. 기본적으로 이 옵션이 정의되지 않으면 Payload는 자동으로 payload 접두사가 있는 쿠키를 필터링합니다. |
| **`filesRequiredOnCreate`**    | 생성 시 파일 데이터를 의무화합니다. 기본값은 true입니다.                                                                                                                                                                                                                      |
| **`filenameCompoundIndex`**    | 기본 파일명 인덱스 대신 복합 인덱스에 사용할 필드 슬러그입니다.                                                                                                                                                                                                                 |
| **`focalPoint`**               | [관리 패널](../admin/overview)에서 초점 선택 도구를 비활성화하려면 `false`로 설정합니다. 초점 선택기는 `imageSizes` 또는 `resizeOptions`가 정의된 경우에만 사용할 수 있습니다. [자세히](#crop-and-focal-point-selector)                                                     |
| **`formatOptions`**            | Sharp 이미지 라이브러리와 함께 사용되어 업로드 파일을 포맷하는 `format`과 `options`가 포함된 객체입니다. [자세히](https://sharp.pixelplumbing.com/api-output#toformat)                                                                                                      |
| **`handlers`**                 | 파일을 가져올 때 실행할 요청 핸들러 배열입니다. 핸들러가 Response를 반환하면 클라이언트로 전송됩니다. 그렇지 않으면 Payload가 파일을 검색하여 다시 전송합니다.                                                                                                                    |
| **`imageSizes`**               | 지정된 경우, 이미지 업로드는 이러한 이미지 크기에 따라 자동으로 크기가 조정됩니다. [자세히](#image-sizes)                                                                                                                                                                      |
| **`mimeTypes`**                | 파일 선택기에서 MIME 타입을 제한합니다. 유효한 MIME 타입 또는 MIME 타입 와일드카드 배열 [자세히](#mimetypes)                                                                                                                                                                  |
| **`pasteURL`**                 | 업로드 필드에 붙여넣어 원격 URL에서 파일을 업로드할 수 있는지 제어합니다. **기본적으로 활성화됩니다.** 비활성화하려면 `false`를, 유효한 원격 URL의 `allowList`가 포함된 객체를 허용합니다. [자세히](#uploading-files-from-remote-urls)                                      |
| **`resizeOptions`**            | 업로드된 파일의 크기를 조정하기 위해 Sharp 이미지 라이브러리에 전달되는 객체입니다. [자세히](https://sharp.pixelplumbing.com/api-resize)                                                                                                                                     |
| **`skipSafeFetch`**            | 외부 파일을 가져올 때 안전한 가져오기 확인을 건너뛰려면 `allowList`로 설정합니다. 이 컬렉션의 모든 문서에 대해 안전한 가져오기를 건너뛰려면 `true`로 설정합니다. 기본값은 `false`입니다.                                                                                      |
| **`allowRestrictedFileTypes`** | 제한된 파일 유형을 허용하려면 `true`로 설정합니다. 컬렉션에 [mimeTypes](#mimetypes)가 정의되어 있으면 제한된 파일 확인이 건너뛰어집니다. 기본값은 `false`입니다. [자세히](#restricted-file-types)                                                                            |
| **`staticDir`**                | 미디어를 저장하는 데 사용할 폴더 디렉터리입니다. 절대 경로이거나 구성이 포함된 디렉터리에 상대적인 경로일 수 있습니다. 기본값은 컬렉션 슬러그입니다                                                                                                                             |
| **`trimOptions`**              | 업로드된 파일을 다듬기 위해 Sharp 이미지 라이브러리에 전달되는 객체입니다. [자세히](https://sharp.pixelplumbing.com/api-resize#trim)                                                                                                                                        |
| **`withMetadata`**             | 지정된 경우, 출력 이미지 파일에 메타데이터를 추가합니다. 불린값이나 `metadata`와 `req`를 받아 불린값을 반환하는 함수를 허용합니다.                                                                                                                                           |
| **`hideFileInputOnCreate`**    | 문서 생성 중에 관리 UI가 파일 입력을 표시하지 않도록 하려면 `true`로 설정합니다. 프로그래밍 방식의 파일 생성에 유용합니다.                                                                                                                                                    |
| **`hideRemoveFile`**           | 편집 중에 관리 UI가 기존 파일을 제거할 방법을 갖지 않도록 하려면 `true`로 설정합니다.                                                                                                                                                                                       |
| **`modifyResponseHeaders`**    | 기존 `headers`가 있는 객체를 허용하고 미디어 파일의 응답 헤더를 조작할 수 있도록 합니다. [자세히](#modifying-response-headers)                                                                                                                                               |

### Payload 전체 업로드 옵션

업로드 옵션은 컬렉션별로 지정할 수 있으며, 모든 `Busboy` 구성 옵션을 지원하는 객체를 포함하는 `upload` 속성을 기본 Payload 구성에 전달하여 앱 전체 옵션을 제어할 수도 있습니다.

| 옵션                     | 설명                                                                                                                                                                 |
| ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`abortOnLimit`**       | 파일이 파일 크기 제한을 초과하면 HTTP 413을 반환하는 불린값입니다. `false`이면 파일이 잘립니다. 기본값은 `false`입니다.                                              |
| **`createParentPath`**   | 임시 디렉터리 또는 버퍼에서 파일을 이동할 때 디렉터리 경로를 자동으로 생성하려면 `true`로 설정합니다. 기본값은 `false`입니다.                                       |
| **`debug`**              | `true`이면 업로드 프로세스 로깅을 켜고 `false`이면 끄는 불린값입니다. 문제 해결에 유용합니다. 기본값은 `false`입니다.                                               |
| **`limitHandler`**       | 파일이 구성된 제한보다 큰 경우 호출되는 함수입니다.                                                                                                                  |
| **`parseNested`**        | `req.body`와 `req.files`를 중첩된 구조로 변환하려면 `true`로 설정합니다. 기본적으로 `req.body`와 `req.files`는 플랫 객체입니다. 기본값은 `false`입니다.              |
| **`preserveExtension`**  | `safeFileNames` 옵션으로 파일 확장자를 보존합니다. `true`이면 파일 이름을 3자로 제한하거나 `number`이면 사용자 정의 길이로 제한하여 확장자 시작에서 자릅니다.         |
| **`responseOnLimit`**    | `abortOnLimit`와 함께 사용할 때 파일 크기 제한을 초과하면 클라이언트에 응답으로 전송되는 `string`입니다.                                                              |
| **`safeFileNames`**      | 대시와 밑줄을 제외한 영숫자가 아닌 문자를 제거하려면 `true`로 설정합니다. 제거할 내용을 결정하는 정규식으로 설정할 수도 있습니다. 기본값은 `false`입니다.             |
| **`tempFileDir`**        | `useTempFiles` 옵션이 `true`로 설정된 경우 사용되는 임시 파일을 저장할 `string` 경로입니다. 기본값은 `'./tmp'`입니다.                                              |
| **`uploadTimeout`**      | 중단하기 전에 데이터를 기다리는 시간을 밀리초 단위로 정의하는 `number`입니다. 시간 제한 확인을 비활성화하려면 `0`으로 설정합니다. 기본값은 `60000`입니다.            |
| **`uriDecodeFileNames`** | 파일 이름에 URI 디코딩을 적용하려면 `true`로 설정합니다. 기본값은 `false`입니다.                                                                                     |
| **`useTempFiles`**       | 메모리가 아닌 임시 디렉터리에 파일을 저장하여 대용량 파일이나 많은 파일에 대한 메모리 사용량을 줄이려면 `true`로 설정합니다.                                          |

`Busboy`로 제어할 수 있는 것에 대한 자세한 문서는 [여기를 클릭](https://github.com/mscdex/busboy#api)하세요.

Payload 전체 업로드 옵션 내에서 사용자 정의하고 싶을 수 있는 일반적인 예는 Payload에 전송되는 업로드의 허용 `fileSize`를 늘리는 것입니다:

```ts
import { buildConfig } from 'payload'

export default buildConfig({
  collections: [
    {
      slug: 'media',
      fields: [
        {
          name: 'alt',
          type: 'text',
        },
      ],
      upload: true,
    },
  ],
  upload: {
    limits: {
      fileSize: 5000000, // 5MB, 바이트로 작성됨
    },
  },
})
```

### 훅을 통한 사용자 정의 파일명

`beforeOperation` 훅을 사용하여 서버에 업로드되기 전에 파일명을 사용자 정의할 수 있습니다.

```ts
beforeOperation: [
  ({ req, operation }) => {
    if ((operation === 'create' || operation === 'update') && req.file) {
      req.file.name = 'test.jpg'
    }
  },
],
```

`req.file` 객체에는 mimeType 및 확장자와 같은 파일에 대한 추가 정보가 있으며, 파일 데이터 자체에 대한 전체 액세스 권한도 있습니다.
여기의 파일명은 활성화된 경우 이미지 크기로도 전달됩니다.

## 이미지 크기

`upload` 구성에 `imageSizes` 배열을 지정하면 Payload는 구성에서 지정된 각 크기에 맞게 업로드를 자동으로 자르고 크기를 조정합니다.

[관리 패널](../admin/overview)은 업로드된 각 파일에 대해 너비, 높이 및 파일 크기를 포함한 모든 사용 가능한 파일을 자동으로 표시합니다.

내부적으로 Payload는 [`sharp`](https://sharp.pixelplumbing.com/api-resize#resize)에 의존하여 이미지 크기 조정을 수행합니다. `sharp`가 이미지 크기를 조정하는 동안 사용할 추가 옵션을 지정할 수 있습니다.

이미지 크기 조정이 작동하려면 [Payload 구성](../configuration/overview)에서 `sharp`를 지정해야 합니다. `create-payload-app`으로 Payload 프로젝트를 생성한 경우 기본적으로 구성됩니다. [구성 옵션](../configuration/overview#config-options)에서 `sharp`를 참조하세요.

#### 훅에서 크기 조정된 이미지 액세스

모든 자동 크기 조정된 이미지는 `req.payloadUploadSizes`에 바인딩된 객체를 통해 훅 등에서 재사용하도록 노출됩니다.

객체에는 생성된 각 크기에 대한 키가 있으며, 각 키는 파일 데이터를 포함하는 버퍼와 같게 설정됩니다.

#### 이미지 확대 처리

업로드된 이미지가 정의된 이미지 크기보다 작은 경우, 3가지 옵션이 있습니다:

`withoutEnlargement: undefined | false | true`

1. `undefined` [기본값]: 이미지 크기보다 너비와 높이가 모두 작은 이미지를 업로드하면 null을 반환합니다
2. `false`: 항상 이미지를 이미지 크기로 확대합니다
3. `true`: 이미지가 이미지 크기보다 작으면 원본 이미지를 반환합니다

<Banner type="error">
  **참고:**

기본적으로 업로드된 이미지가 정의된 이미지 크기보다 작을 때 이미지 크기는 NULL을 반환합니다. 이를 변경하려면 `withoutEnlargement` prop을 사용하세요.

</Banner>

#### 크기별 사용자 정의 파일 이름

각 이미지 크기는 크기 조정된 이미지에 대한 사용자 정의 파일 이름을 생성하는 데 사용할 수 있는 `generateImageName` 함수를 지원합니다.
이 함수는 원본 파일 이름, 크기 조정 이름, 확장자, 높이 및 너비를 인수로 받습니다.

```ts
{
  name: 'thumbnail',
  width: 400,
  height: 300,
  generateImageName: ({ height, sizeName, extension, width }) => {
    return `custom-${sizeName}-${height}-${width}.${extension}`
  },
}
```

## 자르기 및 초점 선택기

이 기능은 이미지 파일 유형에만 사용할 수 있습니다.

업로드 구성에서 `crop: false` 및 `focalPoint: false`로 설정하면 [관리 패널](../admin/overview)에서 해당 선택기가 비활성화됩니다.

이미지 자르기는 크기 조정 전에 발생하므로 크기 조정된 이미지는 자른 이미지에서 생성됩니다 (원본 이미지가 **아님**).

크기 조정 옵션이 지정되지 않으면 (`imageSizes` 또는 `resizeOptions`) 초점 선택기가 표시되지 않습니다.

## 로컬 업로드 저장소 비활성화

Amazon S3 또는 유사한 제3자 파일 저장소 호스트나 CDN으로 파일을 전송하는 플러그인을 사용하는 경우 파일을 로컬에 전혀 저장하고 싶지 않을 수 있습니다. 컬렉션의 업로드 구성에서 `disableLocalStorage: true`를 지정하여 Payload가 디스크에 파일을 쓰는 것을 방지할 수 있습니다.

<Banner type="warning">
  **참고:**

이것은 상당히 고급 기능입니다. 로컬 파일 저장소를 비활성화하면 기본적으로 파일을 저장하지 않았기 때문에 관리 패널의 썸네일이 깨집니다. 플러그인이나 자체 훅을 사용하여 파일을 영구적으로 저장하고 **upload.adminThumbnail**을 사용하여 자체 관리 썸네일을 제공하는 것은 전적으로 사용자의 책임입니다.

</Banner>

## 관리 썸네일

다음 중 하나를 사용하여 업로드가 활성화된 컬렉션에 대해 Payload가 관리 썸네일을 검색하는 방법을 지정할 수 있습니다:

1. 제공된 이미지 크기 이름 중 하나와 같은 **문자열**로서의 `adminThumbnail`.

```ts
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    // highlight-start
    adminThumbnail: 'small',
    // highlight-end
    imageSizes: [
      {
        name: 'small',
        fit: 'cover',
        height: 300,
        width: 900,
      },
      {
        name: 'large',
        fit: 'cover',
        height: 600,
        width: 1800,
      },
    ],
  },
}
```

2. 문서의 데이터를 받아 썸네일을 로드할 전체 URL을 다시 보내는 **함수**로서의 `adminThumbnail`.

```ts
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    // highlight-start
    adminThumbnail: ({ doc }) =>
      `https://google.com/custom-path-to-file/${doc.filename}`,
    // highlight-end
  },
}
```

## 제한된 파일 유형

문제가 될 수 있는 파일 유형은 자동으로 애플리케이션에 업로드되는 것이 제한됩니다.
컬렉션에 [mimeTypes](#mimetypes)가 정의되어 있거나 `allowRestrictedFileTypes`가 `true`로 설정된 경우 제한된 파일 확인이 건너뛰어집니다.

제한된 파일 유형 및 확장자:

| 파일 확장자                       | MIME 타입                                        |
| -------------------------------- | ------------------------------------------------ |
| `exe`, `dll`                     | `application/x-msdownload`                       |
| `exe`, `com`, `app`, `action`    | `application/x-executable`                       |
| `bat`, `cmd`                     | `application/x-msdos-program`                    |
| `exe`, `com`                     | `application/x-ms-dos-executable`                |
| `dmg`                            | `application/x-apple-diskimage`                  |
| `deb`                            | `application/x-debian-package`                   |
| `rpm`                            | `application/x-redhat-package-manager`           |
| `exe`, `dll`                     | `application/vnd.microsoft.portable-executable`  |
| `msi`                            | `application/x-msi`                              |
| `jar`, `ear`, `war`              | `application/java-archive`                       |
| `desktop`                        | `application/x-desktop`                          |
| `cpl`                            | `application/x-cpl`                              |
| `lnk`                            | `application/x-ms-shortcut`                      |
| `pkg`                            | `application/x-apple-installer`                  |
| `htm`, `html`, `shtml`, `xhtml`  | `text/html`                                      |
| `php`, `phtml`                   | `application/x-httpd-php`                        |
| `js`, `jse`                      | `text/javascript`                                |
| `jsp`                            | `application/x-jsp`                              |
| `py`                             | `text/x-python`                                  |
| `rb`                             | `text/x-ruby`                                    |
| `pl`                             | `text/x-perl`                                    |
| `ps1`, `psc1`, `psd1`, `psh`, `psm1` | `application/x-powershell`                   |
| `vbe`, `vbs`                     | `application/x-vbscript`                         |
| `ws`, `wsc`, `wsf`, `wsh`        | `application/x-ms-wsh`                           |
| `scr`                            | `application/x-msdownload`                       |
| `asp`, `aspx`                    | `application/x-asp`                              |
| `hta`                            | `application/x-hta`                              |
| `reg`                            | `application/x-registry`                         |
| `url`                            | `application/x-url`                              |
| `workflow`                       | `application/x-workflow`                         |
| `command`                        | `application/x-command`                          |

## MIME 타입

`mimeTypes` 속성을 지정하면 사용자의 파일 선택기에서 허용되는 파일을 제한할 수 있습니다. 이는 유효한 MIME 타입이나 MIME 타입 와일드카드가 될 수 있는 문자열 배열을 허용합니다

일부 예시 값은 다음과 같습니다: `image/*`, `audio/*`, `video/*`, `image/png`, `application/pdf`

**mimeTypes 사용 예시:**

```ts
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    mimeTypes: ['image/*', 'application/pdf'], // highlight-line
  },
}
```

## 파일 업로드

<Banner type="warning">
  **중요:**

GraphQL의 작동 방식으로 인해 현재 REST 및 Local API를 통해서만 파일 업로드가 가능합니다. GraphQL을 통해 파일 업로드를 지원하는 것은 어렵고 상당히 무의미합니다.

</Banner>

파일을 업로드하려면 컬렉션의 [`create`](/docs/rest-api/overview#collections) 엔드포인트를 사용하세요. 컬렉션에 필요한 모든 데이터와 업로드하려는 파일을 포함하는 `file` 키를 전송합니다.

가능하면 [`FormData`](https://developer.mozilla.org/en-US/docs/Web/API/FormData)를 사용하여 요청을 `multipart/form-data` 요청으로 전송하세요.

<Banner type="info">
  **참고:** 추가 필드(`title`, `alt` 등)를 포함하려면 필수 값의 JSON 문자열화된 객체를 포함하는 `_payload` 필드를 추가하세요. 이러한 값은 업로드가 활성화된 컬렉션의 스키마와 일치해야 합니다.
</Banner>

```ts
const fileInput = document.querySelector('#your-file-input')
const formData = new FormData()

formData.append('file', fileInput.files[0])

// 업로드가 활성화된 컬렉션에 정의된 필드로 교체하세요.
// 아래 예시에는 'title'과 같은 선택적 필드가 포함됩니다.
formData.append(
  '_payload',
  JSON.stringify({
    title: 'Example Title',
    description: 'An optional description for the file',
  }),
)

fetch('api/:upload-slug', {
  method: 'POST',
  body: formData,
  /**
   * Content-Type 헤더를 수동으로 추가하지 마세요
   * 브라우저가 이를 처리합니다.
   *
   * headers: {
   *  'Content-Type': 'multipart/form-data'
   * }
   */
})
```

## 로컬에 저장된 파일 업로드

예를 들어 시드 스크립트 중에 `payload.create` 메서드를 사용하여 머신에 저장된 파일을 직접 업로드하려면 `filePath` 속성을 사용하여 파일의 로컬 경로를 지정할 수 있습니다.

```ts
const localFilePath = path.resolve(__dirname, filename)

await payload.create({
  collection: 'media',
  data: {
    alt,
  },
  filePath: localFilePath,
})
```

`data` 속성에는 여전히 `media` 컬렉션의 모든 필수 필드가 포함되어야 합니다.

<Banner type="warning">
  **중요:**

`media` 컬렉션에 첨부된 모든 사용자 정의 훅이 여전히 트리거됩니다.
파일이 컬렉션의 `formatOptions`이나 사용자 정의 `hooks`에 정의된 지정된 mimeType이나 크기와 일치하는지 확인하세요.

</Banner>

## 원격 URL에서 파일 업로드

`pasteURL` 옵션을 사용하면 사용자가 업로드 필드에 붙여넣어 원격 URL에서 파일을 가져올 수 있습니다. 이 옵션은 **기본적으로 활성화**되어 있으며 **무제한 클라이언트 측 가져오기**를 허용하거나 특정 신뢰할 수 있는 도메인으로 **서버 측 가져오기를 제한**하도록 구성할 수 있습니다.

기본적으로 Payload는 **클라이언트 측 가져오기**를 사용하여 브라우저가 제공된 URL에서 직접 파일을 다운로드합니다. 그러나 **URL의 서버에 CORS 제한이 있으면 클라이언트 측 가져오기가 실패**하므로 내부 URL이나 CORS 차단이 없는 공개 URL에만 적합합니다.

CORS에 의해 차단되는 **제한된 URL**에서 파일을 가져오려면 신뢰할 수 있는 도메인의 `allowList`로 `pasteURL` 옵션을 구성하여 **서버 측 가져오기**를 사용하세요. 이 방법은 Payload가 서버에서 파일을 다운로드하고 브라우저로 스트리밍하도록 합니다. 그러나 보안상의 이유로 지정된 `allowList`와 일치하는 URL만 허용됩니다.

#### 구성 예시

원격 URL 가져오기를 제어하도록 pasteURL 옵션을 구성하는 방법은 다음과 같습니다:

```ts
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    pasteURL: {
      allowList: [
        {
          hostname: 'payloadcms.com', // 필수
          pathname: '',
          port: '',
          protocol: 'https',
          search: '',
        },
        {
          hostname: 'example.com',
          pathname: '/images/*',
        },
      ],
    },
  },
}
```

업로드 수준에서도 서버 측 가져오기를 조정할 수 있으며, 이는 `pasteURL` 옵션처럼 `CORS` 정책에 영향을 주지 않지만 특정 URL에 대해 안전한 가져오기 확인을 건너뛸 수 있게 합니다.

```
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    skipSafeFetch: [
      {
        hostname: 'example.com',
        pathname: '/images/*',
      },
    ],
  },
}
```

##### `pasteURL`에 허용되는 값

| 옵션            | 설명                                                                                                                                               |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`undefined`** | 기본 동작입니다. 내부 또는 공개 URL에 대해 클라이언트 측 가져오기를 활성화합니다.                                                                   |
| **`false`**     | 업로드 필드에 URL을 붙여넣는 기능을 비활성화합니다.                                                                                                |
| **`allowList`** | 특정 신뢰할 수 있는 URL에 대해 서버 측 가져오기를 활성화합니다. 신뢰할 수 있는 도메인을 정의하는 객체 배열이 필요합니다. `AllowItem`에 대한 세부 사항은 아래 표를 참조하세요. |

##### `AllowItem` 속성

_별표는 필수 옵션을 나타냅니다._

| 옵션              | 설명                                                                                              | 예시          |
| ----------------- | ------------------------------------------------------------------------------------------------- | ------------- |
| **`hostname`** \* | 허용된 URL의 호스트 이름입니다. URL이 신뢰할 수 있는 소스에서 오는지 확인하기 위해 필요합니다.     | `example.com` |
| **`pathname`**    | URL의 경로 부분입니다. 여러 경로를 일치시키기 위해 와일드카드를 지원합니다.                        | `/images/*`   |
| **`port`**        | URL의 포트 번호입니다. 지정하지 않으면 프로토콜의 기본 포트가 사용됩니다.                          | `3000`        |
| **`protocol`**    | 일치시킬 프로토콜입니다. `http` 또는 `https`여야 합니다. 기본값은 `https`입니다.                   | `https`       |
| **`search`**      | URL의 쿼리 문자열입니다. 지정된 경우 URL이 이 정확한 쿼리 문자열과 일치해야 합니다.                | `?version=1`  |

## 접근 제어

각 컬렉션에 업로드되는 모든 파일은 컬렉션 자체의 `read` [접근 제어](/docs/access-control/overview) 함수를 자동으로 지원합니다. 이를 사용하여 업로드를 볼 수 있는 사람과 그렇지 않은 사람을 제어할 수 있습니다.

## 응답 헤더 수정

업로드 구성에서 `modifyResponseHeaders` 옵션을 지정하여 파일의 응답 헤더를 수정할 수 있습니다. 이 옵션은 기존 헤더가 있는 객체를 허용하고 미디어 파일의 응답 헤더를 조작할 수 있게 합니다.

### 기존 헤더 수정

이 방법으로 `Headers` 객체와 직접 인터페이스하여 기존 헤더를 수정하여 헤더를 추가하거나 제거할 수 있습니다.

```ts
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    modifyResponseHeaders: ({ headers }) => {
      headers.set('X-Frame-Options', 'DENY') // 반환하지 않고 직접 헤더를 설정할 수 있습니다
    },
  },
}
```

### 새 헤더 반환

수정된 헤더로 새 `Headers` 객체를 반환할 수도 있습니다. 새 헤더를 설정하거나 기존 헤더를 제거하려는 경우에 유용합니다.

```ts
import type { CollectionConfig } from 'payload'

export const Media: CollectionConfig = {
  slug: 'media',
  upload: {
    modifyResponseHeaders: ({ headers }) => {
      const newHeaders = new Headers(headers) // 기존 헤더 복사
      newHeaders.set('X-Frame-Options', 'DENY') // 새 헤더 설정

      return newHeaders
    },
  },
}
```