---
title: 관계 필드
label: 관계
order: 130
desc: 관계 필드는 문서들을 서로 연결하는 능력을 제공합니다. 관계 필드 사용 방법, 예제 및 옵션을 확인하세요.
keywords: relationship, fields, config, configuration, documentation, Content Management System, cms, headless, javascript, node, react, nextjs
---

관계 필드는 Payload가 제공하는 가장 강력한 필드 중 하나입니다. 문서들을 쉽게 서로 연결할 수 있는 기능을 제공합니다.

<LightDarkImage
  srcLight="https://payloadcms.com/images/docs/fields/relationship.png"
  srcDark="https://payloadcms.com/images/docs/fields/relationship-dark.png"
  alt="Payload 관리 패널의 관계 필드 표시"
  caption="관계 필드의 관리 패널 스크린샷"
/>

관계 필드는 다음과 같은 다양한 방식으로 사용됩니다:

- `Order` 문서에 `Product` 문서들을 추가하기
- `Order`가 `Organization` 또는 `User` 컬렉션에 대한 `placedBy` 관계를 갖도록 허용하기
- `Post` 문서에 `Category` 문서들을 할당하기

관계 필드를 추가하려면 [필드 구성](./overview)에서 `type`을 `relationship`으로 설정하세요:

```ts
import type { Field } from 'payload'

export const MyRelationshipField: Field = {
  // ...
  // highlight-start
  type: 'relationship',
  relationTo: 'products',
  // highlight-end
}
```

## 구성 옵션

| 옵션                    | 설명                                                                                                                                                                                                                                                |
| ---------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`name`** \*          | 데이터베이스에 저장되고 검색될 때 속성 이름으로 사용됩니다. [자세한 정보](/docs/fields/overview#field-names).                                                                                                                                          |
| **`relationTo`** \*    | 관계를 할당할 수 있는 하나 또는 여러 컬렉션 `slug`를 제공합니다.                                                                                                                                                                                     |
| **`filterOptions`**    | UI에 나타나는 옵션을 필터링하고 검증하는 쿼리입니다. [자세한 정보](#filtering-relationship-options).                                                                                                                                               |
| **`hasMany`**          | `true`로 설정하면 이 필드가 하나가 아닌 여러 관계를 가질 수 있도록 허용하는 불린값입니다.                                                                                                                                                            |
| **`minRows`**          | 값이 있을 때 검증 시 허용되는 최소 항목 수입니다. `hasMany`와 함께 사용됩니다.                                                                                                                                                                      |
| **`maxRows`**          | 값이 있을 때 검증 시 허용되는 최대 항목 수입니다. `hasMany`와 함께 사용됩니다.                                                                                                                                                                      |
| **`maxDepth`**         | 이 필드에 도달했을 때 남은 깊이와 관계없이 이 필드에 대한 최대 채우기 깊이를 설정합니다. [최대 깊이](/docs/queries/depth#max-depth)                                                                                                                |
| **`label`**            | 관리 패널에서 필드 라벨로 사용되는 텍스트 또는 각 언어의 키를 가진 객체입니다.                                                                                                                                                                      |
| **`unique`**           | 컬렉션의 각 항목이 이 필드에 대해 고유한 값을 갖도록 강제합니다.                                                                                                                                                                                   |
| **`validate`**         | 관리 패널과 백엔드 모두에서 실행될 사용자 정의 검증 함수를 제공합니다. [자세한 정보](/docs/fields/overview#validation).                                                                                                                            |
| **`index`**            | 더 빠른 쿼리를 생성하기 위해 이 필드에 대한 [인덱스](../database/indexes)를 구축합니다. 사용자가 이 필드의 데이터를 자주 쿼리하는 경우 이 필드를 `true`로 설정하세요.                                                                              |
| **`saveToJWT`**        | 이 필드가 최상위 레벨이고 [인증](/docs/authentication/overview)을 지원하는 구성에 중첩된 경우, 사용자 JWT에 해당 데이터를 포함합니다.                                                                                                             |
| **`hooks`**            | 이 필드에 대한 로직을 제어하기 위해 필드 훅을 제공합니다. [자세한 정보](../hooks/fields).                                                                                                                                                           |
| **`access`**           | 사용자가 이 필드의 데이터로 무엇을 보고 할 수 있는지를 나타내는 필드 접근 제어를 제공합니다. [자세한 정보](../access-control/fields).                                                                                                            |
| **`hidden`**           | 모든 API에서 이 필드의 가시성을 완전히 제한합니다. 여전히 데이터베이스에 저장되지만 어떤 API나 관리 패널에도 나타나지 않습니다.                                                                                                                    |
| **`defaultValue`**     | 이 필드의 기본값으로 사용할 데이터를 제공합니다. [자세한 정보](/docs/fields/overview#default-values).                                                                                                                                              |
| **`localized`**        | 이 필드에 대해 지역화를 활성화합니다. 기본 구성에서 [지역화가 활성화되어야 합니다](/docs/configuration/localization).                                                                                                                            |
| **`required`**         | 이 필드에 값이 있어야 합니다.                                                                                                                                                                                                                      |
| **`admin`**            | 관리자별 구성입니다. [자세한 정보](#admin-options).                                                                                                                                                                                                |
| **`custom`**           | 사용자 정의 데이터(예: 플러그인용)를 추가하기 위한 확장 지점입니다.                                                                                                                                                                               |
| **`typescriptSchema`** | JSON 스키마를 제공하여 필드 타입 생성을 재정의합니다.                                                                                                                                                                                              |
| **`virtual`**          | 데이터베이스에서 필드를 비활성화하려면 `true`를 제공하거나, [필드를 관계와 연결](/docs/fields/relationship#linking-virtual-fields-with-relationships)하려면 문자열 경로를 제공하세요. [가상 필드](https://payloadcms.com/blog/learn-how-virtual-fields-can-help-solve-common-cms-challenges) 참조 |
| **`graphQL`**          | 필드에 대한 사용자 정의 GraphQL 구성입니다. [자세한 정보](/docs/graphql/overview#field-complexity)                                                                                                                                                |

_\* 별표는 필수 속성을 나타냅니다._

<Banner type="success">
  **팁:** [깊이](../queries/depth) 매개변수를 사용하여 API에서 반환되는 관련 문서를 자동으로 채울 수 있습니다.
</Banner>

## 관리자 옵션

[관리 패널](../admin/overview)에서 관계 필드의 모양과 동작을 설정하려면 `admin` 옵션을 사용할 수 있습니다:

```ts
import type { Field } from 'payload'

export const MyRelationshipField: Field = {
  // ...
  admin: {
    // highlight-line
    // ...
  },
}
```

관계 필드는 기본 [필드 관리자 구성](./overview#admin-options)의 모든 기본 관리자 옵션을 상속받으며, 다음과 같은 추가 옵션들이 있습니다:

| 속성              | 설명                                                                                                                              |
| ----------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| **`isSortable`**  | 관리 UI 내에서 드래그 앤 드롭을 사용하여 이 필드를 정렬 가능하게 하려면 `true`로 설정하세요 (`hasMany`가 `true`로 설정된 경우에만 작동). |
| **`allowCreate`** | 관계 필드 내에서 새 문서를 만드는 기능을 비활성화하려면 `false`로 설정하세요.                                                      |
| **`allowEdit`**   | 관계 필드 내에서 문서를 편집하는 기능을 비활성화하려면 `false`로 설정하세요.                                                       |
| **`sortOptions`** | 관계 필드 드롭다운 내 옵션에 대한 기본 정렬 순서를 정의합니다. [자세한 정보](#sort-options)                                        |
| **`placeholder`** | 일반적인 기본 플레이스홀더를 대체할 사용자 정의 텍스트 또는 함수를 정의합니다.                                                    |
| **`appearance`**  | 필드의 동작을 변경하려면 `drawer` 또는 `select`로 설정하세요. 기본값은 `select`입니다.                                             |

### 정렬 옵션

`sortOptions`는 두 가지 방식으로 지정할 수 있습니다:

**문자열로:**

여러 컬렉션에 걸친 모든 관계 필드 드롭다운에 대한 전역 기본 정렬 필드를 정의하기 위해 문자열을 제공합니다. 필드 이름 앞에 마이너스 기호("-")를 붙여 내림차순으로 정렬할 수 있습니다.

예제:

```ts
sortOptions: 'fieldName',
```

이 구성은 모든 관계 필드 드롭다운을 `"fieldName"`으로 오름차순으로 정렬합니다.

**객체로:**

키가 컬렉션 슬러그이고 값이 정렬할 필드 이름을 나타내는 문자열인 객체를 지정합니다. 이는 각 컬렉션의 관계 드롭다운에 대해 서로 다른 정렬 필드를 허용합니다.

예제:

```ts
sortOptions: {
  "pages": "fieldName1",
  "posts": "-fieldName2",
  "categories": "fieldName3"
}
```

이 구성에서:

- `pages`와 관련된 드롭다운은 `"fieldName1"`으로 오름차순 정렬됩니다.
- `posts`의 드롭다운은 `"fieldName2"`를 사용하여 내림차순으로 정렬됩니다("-" 접두사로 표시).
- `categories`와 연관된 드롭다운은 `"fieldName3"`을 기준으로 오름차순 정렬됩니다.

참고: `sortOptions`가 정의되지 않으면 관계 필드 드롭다운의 기본 정렬 동작이 사용됩니다.

## 관계 옵션 필터링

[쿼리 제약 조건](/docs/queries/overview)을 제공하여 옵션을 동적으로 제한할 수 있으며, 이는 입력 검증과 UI에서 사용 가능한 관계 필터링 모두에 사용됩니다.

`filterOptions` 속성은 `Where` 쿼리이거나, 필터링하지 않으려면 `true`를, 모두 방지하려면 `false`를, 또는 `Where` 쿼리를 반환하는 함수일 수 있습니다. 함수를 사용할 때는 다음 속성을 가진 인수 객체로 호출됩니다:

| 속성          | 설명                                                                                                                                                              |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `blockData`   | 가장 가까운 부모 블록의 데이터입니다. 필드가 블록 내에 없거나 목록 보기의 `Filter` 컴포넌트에서 호출될 때는 `undefined`가 됩니다.                                |
| `data`        | 현재 편집 중인 전체 컬렉션 또는 글로벌 문서를 포함하는 객체입니다. 목록 보기의 `Filter` 컴포넌트에서 호출될 때는 빈 객체가 됩니다.                               |
| `id`          | 현재 편집 중인 문서의 `id`입니다. `create` 작업 중이거나 목록 보기의 `Filter` 컴포넌트에서 호출될 때는 `undefined`가 됩니다.                                     |
| `relationTo`  | 이 필드의 `relationTo` 속성으로 제한된 필터링할 컬렉션 `slug`입니다.                                                                                             |
| `req`         | `payload`, `user`, `locale` 등에 대한 참조를 포함하는 Payload Request입니다.                                                                                     |
| `siblingData` | 이 필드의 동일한 부모 내에서만 필드들로 범위가 지정된 문서 데이터를 포함하는 객체입니다. 목록 보기의 `Filter` 컴포넌트에서 호출될 때는 빈 객체가 됩니다.         |
| `user`        | 현재 인증된 사용자를 포함하는 객체입니다.                                                                                                                        |

## 예제

```ts
import type { CollectionConfig } from 'payload'

export const ExampleCollection: CollectionConfig = {
  slug: 'example-collection',
  fields: [
    {
      name: 'purchase',
      type: 'relationship',
      relationTo: ['products', 'services'],
      filterOptions: ({ relationTo, siblingData }) => {
        // 관계 유형에 따라 Where 쿼리를 동적으로 반환합니다
        if (relationTo === 'products') {
          return {
            stock: { greater_than: siblingData.quantity },
          }
        }

        if (relationTo === 'services') {
          return {
            isAvailable: { equals: true },
          }
        }
      },
    },
  ],
}
```

쿼리 작성에 대한 자세한 내용은 [여기](/docs/queries/overview)에서 확인할 수 있습니다.

<Banner type="warning">
  **참고:**

관계 필드에 **filterOptions**와 사용자 정의 **validate** 함수가 모두 있을 때, validate 함수에서 **payload/shared**에서 가져온 기본 관계 필드 검증 함수를 호출하지 않으면 API가 **filterOptions**를 검증하지 않습니다.

</Banner>

## 양방향 관계

`relationship` 필드 자체는 관계 필드를 포함하는 문서에 대한 관계를 정의하는 데 사용되며, 이는 "단방향" 관계로 간주할 수 있습니다. 예를 들어, Post에 `category` 관계 필드가 있는 경우, 관련된 `category` 자체는 해당 카테고리가 설정된 포스트에 대한 정보를 표시하지 않습니다.

그러나 `relationship` 필드는 `Join` 필드와 함께 사용하여 강력한 양방향 관계 작성 기능을 생성할 수 있습니다. 양방향 관계에 관심이 있다면 [Join 필드에 대한 문서](./join)를 확인하세요.

## 데이터가 저장되는 방식

`relationship` 필드 유형 내에서 가능한 옵션의 다양성을 고려할 때, 이러한 필드를 생성하고 업데이트하는 데 필요한 데이터의 모양이 달라질 수 있습니다. 다음 섹션들은 이 필드에서 발생할 수 있는 다양한 데이터 모양을 설명합니다.

### Has One

관계의 가장 간단한 패턴은 한 종류의 컬렉션만 허용하는 `relationTo`와 함께 `hasMany: false`를 사용하는 것입니다.

```ts
{
  slug: 'example-collection',
  fields: [
    {
      name: 'owner', // 필수
      type: 'relationship', // 필수
      relationTo: 'users', // 필수
      hasMany: false,
    }
  ]
}
```

이렇게 구성된 필드를 가진 문서에 저장할 데이터의 모양은 다음과 같습니다:

```json
{
  // 관련된 사용자의 ObjectID
  "owner": "6031ac9e1289176380734024"
}
```

REST API를 통해 이 컬렉션의 문서를 쿼리할 때는 다음과 같이 쿼리할 수 있습니다:

`?where[owner][equals]=6031ac9e1289176380734024`.

### Has One - 다형성

**동적 참조**라고도 알려진 이 구성에서는 `relationTo` 필드가 Payload에게 어떤 컬렉션을 참조하는 것이 유효한지 알려주는 컬렉션 슬러그들의 배열입니다.

```ts
{
  slug: 'example-collection',
  fields: [
    {
      name: 'owner', // 필수
      type: 'relationship', // 필수
      relationTo: ['users', 'organizations'], // 필수
      hasMany: false,
    }
  ]
}
```

둘 이상의 관계 유형을 가진 문서에 저장할 데이터의 모양은 다음과 같습니다:

```json
{
  "owner": {
    "relationTo": "organizations",
    "value": "6031ac9e1289176380734024"
  }
}
```

이 데이터로 문서를 쿼리하는 방법의 예는 다음과 같습니다 (`owner.value` 참조의 차이점에 주목):

`?where[owner.value][equals]=6031ac9e1289176380734024`.

필드가 특정 컬렉션에 대한 관계를 가진 문서를 쿼리할 수도 있습니다:

`?where[owners.relationTo][equals]=organizations`.

이 쿼리는 조직에 대한 소유자 관계를 가진 문서만 반환합니다.

### Has Many

`hasMany`는 필드에 하나 이상의 컬렉션이 저장될 수 있다고 Payload에게 알려줍니다.

```ts
{
  slug: 'example-collection',
  fields: [
    {
      name: 'owners', // 필수
      type: 'relationship', // 필수
      relationTo: 'users', // 필수
      hasMany: true,
    }
  ]
}
```

`hasMany` 관계 필드에 저장하려면 ID 배열을 보내야 합니다:

```json
{
  "owners": ["6031ac9e1289176380734024", "602c3c327b811235943ee12b"]
}
```

문서를 쿼리할 때 배열의 형식은 변경되지 않습니다:

`?where[owners][equals]=6031ac9e1289176380734024`.

### Has Many - 다형성

```ts
{
  slug: 'example-collection',
  fields: [
    {
      name: 'owners', // 필수
      type: 'relationship', // 필수
      relationTo: ['users', 'organizations'], // 필수
      hasMany: true,
      required: true,
    }
  ]
}
```

`hasMany`가 하나 이상의 종류의 컬렉션으로 설정된 관계 필드는 데이터를 객체 배열로 저장합니다—각각은 `relationTo` 값으로 컬렉션 `slug`을, `value`로 관련된 문서 `id`를 포함합니다:

```json
{
  "owners": [
    {
      "relationTo": "users",
      "value": "6031ac9e1289176380734024"
    },
    {
      "relationTo": "organizations",
      "value": "602c3c327b811235943ee12b"
    }
  ]
}
```

쿼리는 이전의 다형성 예제와 같은 방식으로 수행됩니다:

`?where[owners.value][equals]=6031ac9e1289176380734024`.

### 다형성 관계 쿼리 및 필터링

다형성 및 비다형성 관계는 관련 데이터가 저장되는 방식과 다른 컬렉션 간에 일관성이 없을 수 있기 때문에 다르게 쿼리되어야 합니다. 이 때문에 컬렉션 목록 관리 UI에서 다형성 관계 필드를 필터링하는 것은 `id` 값으로 제한됩니다.

다형성 관계의 경우 응답은 항상 객체 배열이 됩니다. 각 객체에는 `relationTo`와 `value` 속성이 포함됩니다.

데이터는 관련된 문서 ID로 쿼리할 수 있습니다:

`?where[field.value][equals]=6031ac9e1289176380734024`.

또는 관련된 문서 컬렉션 슬러그로:

`?where[field.relationTo][equals]=your-collection-slug`.

하지만 관련된 문서 내의 필드 값으로는 쿼리할 **수 없습니다**.
여러 컬렉션을 참조하고 있기 때문에 쿼리하는 필드가 존재하지 않을 수 있어 쿼리를 중단시킬 수 있습니다.

<Banner type="warning">
  **참고:**

비다형성 관계와 같이 다형성 관계 내의 필드로는 쿼리할 **수 없습니다**.

</Banner>

### 관계와 가상 필드 연결

관계(또는 업로드) 필드를 통해 가상 필드를 다른 컬렉션의 필드와 연결할 수 있습니다. 예를 들어:

```ts
{
  collections: [
    {
      slug: 'categories',
      fields: [
        {
          name: 'title',
          type: 'text',
        },
      ],
    },
    {
      slug: 'posts',
      fields: [
        {
          type: 'relationship',
          name: 'category',
          relationTo: 'categories',
        },
        {
          type: 'text',
          name: 'categoryTitle',
          virtual: 'category.title',
        },
      ],
    },
  ],
}
```

여기서 `categoryTitle`은 현재 `depth`가 `0`이더라도 _항상_ 해당 값으로 채워집니다. 이 필드로 쿼리하고 정렬할 수도 있습니다.
관계는 `hasMany: true`이거나 다형성이어서는 안 됩니다.
모든 관계 필드가 위의 요구 사항을 충족하는 한 경로는 2개 이상의 관계 필드로 깊게 중첩될 수 있습니다(예: `post.category.title`).

## 사용자 정의 컴포넌트

### 필드

#### 서버 컴포넌트

```tsx
import type React from 'react'
import { RelationshipField } from '@payloadcms/ui'
import type { RelationshipFieldServerComponent } from 'payload'

export const CustomRelationshipFieldServer: RelationshipFieldServerComponent =
  ({ clientField, path, schemaPath, permissions }) => {
    return (
      <RelationshipField
        field={clientField}
        path={path}
        schemaPath={schemaPath}
        permissions={permissions}
      />
    )
  }
```

#### 클라이언트 컴포넌트

```tsx
'use client'
import React from 'react'
import { RelationshipField } from '@payloadcms/ui'
import type { RelationshipFieldClientComponent } from 'payload'

export const CustomRelationshipFieldClient: RelationshipFieldClientComponent = (
  props,
) => {
  return <RelationshipField {...props} />
}
```

### 라벨

#### 서버 컴포넌트

```tsx
import React from 'react'
import { FieldLabel } from '@payloadcms/ui'
import type { RelationshipFieldLabelServerComponent } from 'payload'

export const CustomRelationshipFieldLabelServer: RelationshipFieldLabelServerComponent =
  (clientField, path) => {
    return (
      <FieldLabel
        label={clientField?.label || clientField?.name}
        path={path}
        required={clientField?.required}
      />
    )
  }
```

#### 클라이언트 컴포넌트

```tsx
'use client'
import React from 'react'
import { FieldLabel } from '@payloadcms/ui'
import type { RelationshipFieldLabelClientComponent } from 'payload'

export const CustomRelationshipFieldLabelClient: RelationshipFieldLabelClientComponent =
  ({ field, path }) => {
    return (
      <FieldLabel
        label={field?.label || field?.name}
        path={path}
        required={field?.required}
      />
    )
  }
```