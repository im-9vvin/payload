---
title: MongoDB
label: MongoDB
order: 50
desc: Payload는 시작부터 MongoDB를 기본적으로 지원해왔습니다. MongoDB의 유연한 특성은 Payload의 강력한 필드와 잘 어울립니다.
keywords: MongoDB, 문서, typescript, 콘텐츠 관리 시스템, cms, 헤드리스, javascript, node, react, nextjs
---

Payload를 MongoDB와 함께 사용하려면 `@payloadcms/db-mongodb` 패키지를 설치하세요. MongoDB에 Payload 데이터를 저장하는 데 필요한 모든 것이 포함되어 있습니다.

그 다음, 다음과 같이 Payload Config에 전달하세요:

```ts
import { mongooseAdapter } from '@payloadcms/db-mongodb'

export default buildConfig({
  // config가 여기에 들어갑니다
  collections: [
    // 컬렉션이 여기에 들어갑니다
  ],
  // 여기서 Mongoose 어댑터를 구성합니다
  db: mongooseAdapter({
    // Mongoose 관련 인수가 여기에 들어갑니다.
    // URL은 필수입니다.
    url: process.env.DATABASE_URI,
  }),
})
```

## 옵션

| 옵션                         | 설명                                                                                                                                                                                                                                                                          |
| ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `autoPluralization`          | 컬렉션 `slug`로 사용되는 단수 단어를 발견하면 Mongoose가 컬렉션 이름을 자동으로 복수화하도록 지시합니다.                                                                                                                                                                      |
| `connectOptions`             | MongoDB 연결 옵션을 커스터마이징합니다. Payload는 mongoose에서 사용할 수 있는 모든 [옵션](https://mongoosejs.com/docs/connections.html#options)을 재정의하고 확장할 수 있는 기본 옵션을 사용하여 MongoDB 데이터베이스에 연결합니다.                                           |
| `collectionsSchemaOptions`   | 컬렉션에 대한 Mongoose 스키마 옵션을 커스터마이징합니다.                                                                                                                                                                                                                      |
| `disableIndexHints`          | MongoDB에 'id'를 인덱스로 사용하라는 힌트를 비활성화하려면 true로 설정합니다. 현재 페이지네이션을 위해 문서를 세는 데 사용되며, 해당 쿼리에서 사용되는 count 함수의 속도를 향상시킵니다. 이 최적화를 비활성화하면 AWS DocumentDB의 일부 문제를 해결할 수 있습니다. 기본값은 false |
| `migrationDir`               | 마이그레이션이 저장되는 디렉토리를 커스터마이징합니다.                                                                                                                                                                                                                        |
| `transactionOptions`         | [트랜잭션](https://www.mongodb.com/docs/manual/core/transactions/)에서 사용되는 구성 속성이 있는 객체 또는 트랜잭션 사용을 비활성화하는 `false`입니다.                                                                                                                        |
| `collation`                  | 커스터마이징 가능한 옵션으로 언어별 문자열 비교를 활성화합니다. MongoDB 3.4+에서 사용 가능. 기본 locale은 "en"입니다. 예: `{ strength: 3 }`. 전체 collation 옵션 목록과 정의는 [MongoDB 문서](https://www.mongodb.com/docs/manual/reference/collation/)를 참조하세요.            |
| `allowAdditionalKeys`        | 기본적으로 Payload는 Payload 스키마에 존재하지 않는 MongoDB 데이터에서 모든 추가 키를 제거합니다. 결과에 포함하고 싶지만 Payload에는 존재하지 않는 일부 데이터가 있는 경우 이를 `true`로 설정할 수 있습니다. 이 데이터에 대해서는 Payload 접근 제어가 작동하지 _않으므로_ 주의하세요.  |
| `allowIDOnCreate`            | 커스텀 ID 필드를 사용하지 않고 create API 작업에서 데이터에 전달된 `id`를 사용하려면 `true`로 설정합니다.                                                                                                                                                                    |
| `disableFallbackSort`        | 고유하지 않은 필드로 정렬할 때 어댑터가 fallback 정렬을 추가하는 것을 비활성화하려면 `true`로 설정합니다. 이는 경우에 따라 성능에 영향을 줄 수 있지만 결과의 일관된 순서를 보장합니다.                                                                                        |
| `useAlternativeDropDatabase` | 원시 `dropDatabase` 명령을 보내는 대신 모든 컬렉션에서 `collection.deleteMany({})`를 호출하는 대체 `dropDatabase` 구현을 사용하려면 `true`로 설정합니다. Payload는 테스트 목적으로만 `dropDatabase`를 사용합니다. 기본값은 `false`입니다.                                  |
| `useBigIntForNumberIDs`      | `'number'` 타입의 커스텀 ID 필드에 `BigInt`를 사용하려면 `true`로 설정합니다. `double`이나 `int32` ID를 지원하지 않는 데이터베이스에 유용합니다. 기본값은 `false`입니다.                                                                                                     |
| `useJoinAggregations`        | join aggregations (상관 서브쿼리를 사용하는)을 비활성화하고 대신 여러 `find` 쿼리를 통해 join 필드를 populate하려면 `false`로 설정합니다. 기본값은 `true`입니다.                                                                                                             |
| `usePipelineInSortLookup`    | 정렬에서 `$lookup` aggregation의 `pipeline` 사용을 비활성화하려면 `false`로 설정합니다. 기본값은 `true`입니다.                                                                                                                                                               |

## Mongoose 모델에 대한 액세스

Payload가 초기화된 후, 이 어댑터는 모든 Mongoose 모델을 노출하며 직접 작업할 수 있습니다.

다음과 같이 Mongoose 모델에 액세스할 수 있습니다:

- 컬렉션 모델 - `payload.db.collections[myCollectionSlug]`
- 글로벌 모델 - `payload.db.globals`
- 버전 모델 (컬렉션과 글로벌 모두) - `payload.db.versions[myEntitySlug]`

## 다른 MongoDB 구현 사용

다른 MongoDB 구현에 대한 권장 설정을 얻기 위해 `compatabilityOptions` 객체를 가져올 수 있습니다. 이러한 데이터베이스는 payload에서 공식적으로 지원되지 않으므로 이러한 설정으로도 여전히 문제가 발생할 수 있습니다 (이러한 옵션을 업데이트해야 한다고 생각하면 이슈나 PR을 생성해 주세요):

```ts
import { mongooseAdapter, compatabilityOptions } from '@payloadcms/db-mongodb'

export default buildConfig({
  db: mongooseAdapter({
    url: process.env.DATABASE_URI,
    // 예를 들어, firestore를 사용하는 경우:
    ...compatabilityOptions.firestore,
  }),
})
```

[DocumentDB](https://aws.amazon.com/documentdb/), [Azure Cosmos DB](https://azure.microsoft.com/en-us/products/cosmos-db), [Firestore](https://cloud.google.com/firestore/mongodb-compatibility/docs/overview)에 대한 호환성 옵션을 내보냅니다. 알려진 제한사항:

- Azure Cosmos DB는 서로 다른 컬렉션의 두 개 이상의 문서를 업데이트하는 트랜잭션을 지원하지 않습니다. 이는 Payload 사용 시 (훅을 통해) 일반적인 경우입니다.
- Azure Cosmos DB의 경우 루트 config 속성 `indexSortableFields`가 `true`로 설정되어야 합니다.