---
title: 로컬 API
label: 개요
order: 10
desc: Payload 로컬 API를 사용하면 데이터베이스와 상호 작용하고 Node 내에서 서버에서 직접 REST 및 GraphQL을 통해 사용할 수 있는 동일한 작업을 실행할 수 있습니다.
keywords: local api, config, configuration, documentation, Content Management System, cms, headless, javascript, node, react, nextjs
---

Payload 로컬 API는 Node 내에서 서버에서 직접 REST 및 GraphQL을 통해 사용할 수 있는 동일한 작업을 실행할 수 있는 능력을 제공합니다. 여기서는 서버 지연 시간이나 네트워크 속도를 전혀 처리할 필요가 없으며 데이터베이스와 직접 상호 작용할 수 있습니다.

<Banner type="success">
  **팁:**

로컬 API는 React 서버 컴포넌트 및 기타 유사한 서버 측 컨텍스트에서 사용할 때 매우 강력합니다. 다른 헤드리스 CMS의 경우 HTTP 계층을 통해 타사 서버에서 데이터를 요청해야 하므로 서버 렌더링된 페이지에 상당한 로딩 시간이 추가될 수 있습니다. Payload를 사용하면 필요한 데이터를 수집하기 위해 서버를 떠날 필요가 없습니다. 매우 빠를 수 있으며 확실히 게임 체인저입니다.

</Banner>

다음은 로컬 API를 사용할 수 있는 몇 가지 일반적인 예입니다:

- React 서버 컴포넌트 내에서 Payload 데이터 가져오기
- 작성하고 유지 관리하는 Node 시드 스크립트를 통해 데이터 시딩
- 추가 기능을 제공하지만 여전히 Payload에 의존하는 사용자 정의 Next.js 경로 핸들러 열기
- [접근 제어](../access-control/overview) 및 [훅](../hooks/overview) 내에서

## Payload 액세스

현재 실행 중인 `payload` 객체에 두 가지 방법으로 액세스할 수 있습니다:

#### 인수 또는 `req`에서 액세스

Payload 자체의 대부분의 장소에서는 [훅](../hooks/overview), [접근 제어](../access-control/overview), [검증](../fields/overview#validation) 함수 등의 인수에서 직접 `payload`에 액세스할 수 있습니다. 이는 대부분의 경우 Payload에 액세스하는 가장 간단한 방법입니다. 대부분의 구성 함수는 Payload가 바인딩된 `req`(Request) 객체를 받습니다(`req.payload`).

예시:

```ts
const afterChangeHook: CollectionAfterChangeHook = async ({
  req: { payload },
}) => {
  const posts = await payload.find({
    collection: 'posts',
  })
}
```

#### 가져오기

함수 인수나 `req`에서 액세스할 수 있는 옵션이 없는 곳에서 Payload를 가져오려면, 가져와서 초기화할 수 있습니다.

```ts
import { getPayload } from 'payload'
import config from '@payload-config'

const payload = await getPayload({ config })
```

Next.js의 개발 모드에서 작업하는 경우, Payload는 Hot Module Replacement(HMR)와 작동하며, Payload Config를 변경하면 Payload 사용이 항상 변경 사항과 동기화됩니다. 프로덕션에서 `getPayload`는 모든 HMR 기능을 비활성화하므로 코드를 다르게 작성할 필요가 없습니다. 프로덕션 모드에서는 최적화를 처리합니다.

함수 인수나 `req.payload`를 통해 Payload에 액세스하는 경우, Next.js 내에서 사용하면 HMR이 자동으로 지원됩니다.

Next.js 외부에서 Payload를 사용하는 방법에 대한 자세한 내용은 [여기를 클릭](./outside-nextjs)하세요.

## 사용 가능한 로컬 옵션

서버 전용 컨텍스트에서 실행되므로 REST 또는 GraphQL보다 로컬 API 내에서 더 많은 옵션을 지정할 수 있습니다.

| 로컬 옵션            | 설명                                                                                                                                                                                                                                                                                                                                                           |
| -------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `collection`         | 컬렉션 작업에 필요합니다. 작업할 컬렉션 slug를 지정합니다.                                                                                                                                                                                                                                                                                                    |
| `data`               | 작업 내에서 사용할 데이터입니다. `create`, `update`에 필요합니다.                                                                                                                                                                                                                                                                                              |
| `depth`              | 중첩된 관계 및 업로드 필드의 [자동 채우기 제어](../queries/depth).                                                                                                                                                                                                                                                                                            |
| `locale`             | 반환되는 문서에 대한 [로케일](/docs/configuration/localization) 지정.                                                                                                                                                                                                                                                                                         |
| `select`             | 결과에 포함할 필드를 제어하기 위해 [select](../queries/select) 지정.                                                                                                                                                                                                                                                                                          |
| `populate`           | 채워진 문서에서 결과에 포함할 필드를 제어하기 위해 [populate](../queries/select#populate) 지정.                                                                                                                                                                                                                                                               |
| `fallbackLocale`     | 반환되는 문서에 사용할 [대체 로케일](/docs/configuration/localization) 지정.                                                                                                                                                                                                                                                                                  |
| `overrideAccess`     | 접근 제어 건너뛰기. 기본적으로 이 속성은 모든 로컬 API 작업 내에서 true로 설정됩니다.                                                                                                                                                                                                                                                                         |
| `overrideLock`       | 기본적으로 문서 잠금이 무시됩니다(`true`). 잠금을 적용하고 다른 사용자가 문서를 잠근 경우 작업을 방지하려면 `false`로 설정합니다. [자세한 내용](../admin/locked-documents).                                                                                                                                                                                    |
| `user`               | `overrideAccess`를 `false`로 설정한 경우, 접근 제어 확인에 사용할 사용자를 전달할 수 있습니다.                                                                                                                                                                                                                                                                |
| `showHiddenFields`   | 숨겨진 필드 수신을 선택합니다. 기본적으로 구성에 따라 반환된 문서에서 숨겨집니다.                                                                                                                                                                                                                                                                              |
| `pagination`         | 모든 문서를 반환하고 문서 수 쿼리를 피하려면 false로 설정합니다.                                                                                                                                                                                                                                                                                               |
| `context`            | [컨텍스트](/docs/hooks/context)로, `context`와 `req.context`에 전달되어 훅에서 읽을 수 있습니다. 문서의 일부가 될 필요가 없는 추가 정보를 훅에 전달하려는 경우 유용합니다. 예를 들어 BeforeChange 훅에서 읽어 실행 여부를 결정할 수 있는 `triggerBeforeChange` 옵션.                                                                                        |
| `disableErrors`      | `true`로 설정하면 오류가 발생하지 않습니다. 대신 `findByID` 작업은 `null`을 반환하고 `find` 작업은 빈 문서 배열을 반환합니다.                                                                                                                                                                                                                                  |
| `disableTransaction` | `true`로 설정하면 [데이터베이스 트랜잭션](../database/transactions)이 초기화되지 않습니다.                                                                                                                                                                                                                                                                      |

_아래에 설명된 작업별로 더 많은 옵션이 있습니다._

## 트랜잭션

데이터베이스가 트랜잭션을 사용하는 경우 모든 로컬 작업에 req를 연결해야 합니다. Postgres는 트랜잭션을 사용하고 MongoDB는 복제본 세트를 사용할 때 트랜잭션을 사용합니다. 트랜잭션 없이 req를 전달하는 것도 여전히 권장됩니다.

```js
const post = await payload.find({
  collection: 'posts',
  req, // req 전달이 권장됩니다
})
```

<Banner type="warning">
  **참고:**

기본적으로 로컬 API에서는 모든 접근 제어 확인이 비활성화되지만, 원하는 경우 다시
활성화할 수 있으며 작업을 실행할 특정 사용자를 전달할 수도 있습니다.

</Banner>

## 컬렉션

로컬 API를 통해 다음 컬렉션 작업을 사용할 수 있습니다:

### 생성#collection-create

```js
// 생성된 Post 문서가 반환됩니다
const post = await payload.create({
  collection: 'posts', // 필수
  data: {
    // 필수
    title: 'sure',
    description: 'maybe',
  },
  locale: 'en',
  fallbackLocale: false,
  user: dummyUserDoc,
  overrideAccess: true,
  showHiddenFields: false,

  // 검증이 활성화된 인증 문서를 생성하는 경우,
  // 자동으로 전송되는 이메일을 선택적으로 비활성화할 수 있습니다
  disableVerificationEmail: true,

  // 컬렉션이 업로드를 지원하는 경우, 전체
  // 절대 파일 경로를 제공하여 로컬 API를 통해
  // 직접 파일을 업로드할 수 있습니다.
  filePath: path.resolve(__dirname, './path-to-image.jpg'),

  // 또는 File을 직접 전달할 수 있습니다,
  // file이 제공되면 filePath는 생략됩니다
  file: uploadedFile,

  // 다른 문서의 복제본인 문서를 만들려는 경우
  duplicateFromID: 'document-id-to-duplicate',
})
```

### 찾기#collection-find

```js
// 결과는 페이지네이션된 Posts 세트입니다.
// 자세한 내용은 /docs/queries/pagination을 참조하세요.
const result = await payload.find({
  collection: 'posts', // 필수
  depth: 2,
  page: 1,
  limit: 10,
  pagination: false, // 페이지네이션 카운트 등을 비활성화하려는 경우
  where: {}, // 여기에 `where` 쿼리를 전달하세요
  sort: '-title',
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
```

### ID로 찾기#collection-find-by-id

```js
// 결과는 Post 문서입니다.
const result = await payload.findByID({
  collection: 'posts', // 필수
  id: '507f1f77bcf86cd799439011', // 필수
  depth: 2,
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
```

### 카운트#collection-count

```js
// 결과는 다음과 같은 객체입니다:
// {
//   totalDocs: 10, // 쿼리를 만족하는 문서의 개수
// }
const result = await payload.count({
  collection: 'posts', // 필수
  locale: 'en',
  where: {}, // 여기에 `where` 쿼리를 전달하세요
  user: dummyUser,
  overrideAccess: false,
})
```

### 고유값 찾기#collection-find-distinct

```js
// 결과는 다음과 같은 객체입니다:
// {
//   values: ['value-1', 'value-2'], // 고유값의 배열,
//   field: 'title', // 필드
//   totalDocs: 10, // 쿼리를 만족하는 고유값의 개수,
//   perPage: 10, // 페이지당 고유값의 개수(제공된 제한에 기반)
// }
const result = await payload.findDistinct({
  collection: 'posts', // 필수
  locale: 'en',
  where: {}, // 여기에 `where` 쿼리를 전달하세요
  user: dummyUser,
  overrideAccess: false,
  field: 'title',
  sort: 'title',
})
```

### ID로 업데이트#collection-update-by-id

```js
// 결과는 업데이트된 Post 문서입니다.
const result = await payload.update({
  collection: 'posts', // 필수
  id: '507f1f77bcf86cd799439011', // 필수
  data: {
    // 필수
    title: 'sure',
    description: 'maybe',
  },
  depth: 2,
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  overrideLock: false, // 기본적으로 문서 잠금이 무시됩니다. 잠금을 적용하려면 false로 설정하세요.
  showHiddenFields: true,

  // 컬렉션이 업로드를 지원하는 경우, 전체
  // 절대 파일 경로를 제공하여 로컬 API를 통해
  // 직접 파일을 업로드할 수 있습니다.
  filePath: path.resolve(__dirname, './path-to-image.jpg'),

  // 파일을 업로드하고 새 파일명을 생성하는 대신
  // 기존 파일을 교체하려는 경우,
  // 다음 속성을 `true`로 설정할 수 있습니다
  overwriteExistingFiles: true,
})
```

### 다중 업데이트#collection-update-many

```js
// 결과는 다음과 같은 객체입니다:
// {
//   docs: [], // 업데이트된 각 문서
//   errors: [], // 각 오류는 문서의 id도 포함합니다
// }
const result = await payload.update({
  collection: 'posts', // 필수
  where: {
    // 필수
    fieldName: { equals: 'value' },
  },
  data: {
    // 필수
    title: 'sure',
    description: 'maybe',
  },
  depth: 0,
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  overrideLock: false, // 기본적으로 문서 잠금이 무시됩니다. 잠금을 적용하려면 false로 설정하세요.
  showHiddenFields: true,

  // 컬렉션이 업로드를 지원하는 경우, 전체
  // 절대 파일 경로를 제공하여 로컬 API를 통해
  // 직접 파일을 업로드할 수 있습니다.
  filePath: path.resolve(__dirname, './path-to-image.jpg'),

  // 파일을 업로드하고 새 파일명을 생성하는 대신
  // 기존 파일을 교체하려는 경우,
  // 다음 속성을 `true`로 설정할 수 있습니다
  overwriteExistingFiles: true,
})
```

### 삭제#collection-delete

```js
// 결과는 이제 삭제된 Post 문서입니다.
const result = await payload.delete({
  collection: 'posts', // 필수
  id: '507f1f77bcf86cd799439011', // 필수
  depth: 2,
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  overrideLock: false, // 기본적으로 문서 잠금이 무시됩니다. 잠금을 적용하려면 false로 설정하세요.
  showHiddenFields: true,
})
```

### 다중 삭제#collection-delete-many

```js
// 결과는 다음과 같은 객체입니다:
// {
//   docs: [], // 이제 삭제된 각 문서
//   errors: [], // 발생한 모든 오류, 오류가 발생한 문서의 id 포함
// }
const result = await payload.delete({
  collection: 'posts', // 필수
  where: {
    // 필수
    fieldName: { equals: 'value' },
  },
  depth: 0,
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  overrideLock: false, // 기본적으로 문서 잠금이 무시됩니다. 잠금을 적용하려면 false로 설정하세요.
  showHiddenFields: true,
})
```

## 인증 작업

컬렉션에 [`인증`](/docs/authentication/overview)이 활성화된 경우, 추가 로컬 API 작업을 사용할 수 있습니다:

### 인증

```js
// Next.js를 사용하는 경우, next/headers에서 headers를 가져와야 합니다:
// import { headers as nextHeaders } from 'next/headers'

// 함수나 컴포넌트 내에서 headers를 await해야 합니다:
// const headers = await nextHeaders()

// Next.js 외부에서 Payload를 사용하는 경우, 그에 따라 headers를 제공해야 합니다.

// 결과는 다음과 같이 형식화됩니다:
// {
//    permissions: { ... }, // 현재 사용자의 권한을 포함하는 객체
//    user: { ... }, // 현재 로그인한 사용자의 문서
//    responseHeaders: { ... } // 응답에서 반환된 헤더
// }

const result = await payload.auth({ headers, canSetHeaders: false })
```

### 로그인

```js
// 결과는 다음과 같이 형식화됩니다:
// {
//   token: 'o38jf0q34jfij43f3f...', // 인증에 사용되는 JWT
//   user: { ... } // 방금 로그인한 사용자 문서
//   exp: 1609619861 // JWT가 만료될 UNIX 타임스탬프
// }

const result = await payload.login({
  collection: 'users', // 필수
  data: {
    // 필수
    email: 'dev@payloadcms.com',
    password: 'rip',
  },
  req: req, // 선택사항, 모든 훅에 제공될 Request 객체를 전달
  depth: 2,
  locale: 'en',
  fallbackLocale: false,
  overrideAccess: false,
  showHiddenFields: true,
})
```

### 비밀번호 찾기

```js
// 반환된 토큰은 비밀번호 재설정을 허용합니다
const token = await payload.forgotPassword({
  collection: 'users', // 필수
  data: {
    // 필수
    email: 'dev@payloadcms.com',
  },
  req: req, // 모든 훅에 제공될 Request 객체를 전달
})
```

### 비밀번호 재설정

```js
// 결과는 다음과 같이 형식화됩니다:
// {
//   token: 'o38jf0q34jfij43f3f...', // 인증에 사용되는 JWT
//   user: { ... } // 방금 로그인한 사용자 문서
// }
const result = await payload.resetPassword({
  collection: 'users', // 필수
  data: {
    // 필수
    password: req.body.password, // 설정할 새 비밀번호
    token: 'afh3o2jf2p3f...', // forgotPassword 작업에서 생성된 토큰
  },
  req: req, // 선택사항, 모든 훅에 제공될 Request 객체를 전달
})
```

### 잠금 해제

```js
// 반환된 결과는 성공 또는 실패를 나타내는 불린값입니다
const result = await payload.unlock({
  collection: 'users', // 필수
  data: {
    // 필수
    email: 'dev@payloadcms.com',
  },
  req: req, // 선택사항, 모든 훅에 제공될 Request 객체를 전달
  overrideAccess: true,
})
```

### 인증

```js
// 반환된 결과는 성공 또는 실패를 나타내는 불린값입니다
const result = await payload.verifyEmail({
  collection: 'users', // 필수
  token: 'afh3o2jf2p3f...', // 사용자에게 `_verificationToken`으로 저장된 토큰
})
```

## 글로벌

로컬 API를 통해 다음 글로벌 작업을 사용할 수 있습니다:

### 찾기#global-find

```js
// 결과는 Header 글로벌입니다.
const result = await payload.findGlobal({
  slug: 'header', // 필수
  depth: 2,
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
```

### 업데이트#global-update

```js
// 결과는 업데이트된 Header 글로벌입니다.
const result = await payload.updateGlobal({
  slug: 'header', // 필수
  data: {
    // 필수
    nav: [
      {
        url: 'https://google.com',
      },
      {
        url: 'https://payloadcms.com',
      },
    ],
  },
  depth: 2,
  locale: 'en',
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  overrideLock: false, // 기본적으로 문서 잠금이 무시됩니다. 잠금을 적용하려면 false로 설정하세요.
  showHiddenFields: true,
})
```

## TypeScript

로컬 API 호출은 [생성된 타입](/docs/typescript/generating-types)을 자동으로 추론합니다.

사용 예시는 다음과 같습니다:

```ts
// Post 타입으로 적절히 추론됩니다
const post = await payload.create({
  collection: 'posts',

  // 데이터는 이제 Post로 타입화되고 타입 힌트를 제공합니다
  data: {
    title: 'my title',
    description: 'my description',
  },
})
```